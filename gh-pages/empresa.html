<!doctype html><!-- -->
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Empresas - Sistema</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <!-- Auth Guard - Proteção de acesso -->
  <script src="js/auth-guard.js"></script>
  <script src="js/branding.js"></script>
  <style>
    .empresa-card {
      background: #fff;
      border: 1px solid var(--gray-200, #e5e7eb);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.2s;
    }
    .empresa-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-color: var(--brand, #6366f1);
    }
    .empresa-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 16px;
    }
    .empresa-info h5 {
      font-weight: 600;
      color: var(--gray-800, #1f2937);
      margin-bottom: 4px;
    }
    .empresa-cnpj {
      font-size: 13px;
      color: var(--gray-500, #6b7280);
    }
    .empresa-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }
    .detail-item {
      font-size: 13px;
    }
    .detail-label {
      color: var(--gray-500, #6b7280);
      font-weight: 500;
    }
    .detail-value {
      color: var(--gray-700, #374151);
    }
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--gray-500, #6b7280);
    }
    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    .stats-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .stat-card {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid var(--gray-200, #e5e7eb);
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: #fff;
    }
    .stat-value {
      font-size: 24px;
      font-weight: 800;
      color: var(--gray-800, #1f2937);
    }
    .stat-label {
      font-size: 13px;
      color: var(--gray-500, #6b7280);
    }
    .badge-ativo {
      background: #dcfce7;
      color: #166534;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }
    .badge-inativo {
      background: #fee2e2;
      color: #991b1b;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }
  </style>
</head>
<body>
  <div class="main-wrapper">
    <div class="sidebar">
      <h4>SISTEMA</h4>
      <ul class="sidebar-menu">
        <li><a href="index.html"><span class="menu-icon"><i class="fa fa-home"></i></span><span class="menu-label">Início</span></a></li>
        <li><a href="pdv.html"><span class="menu-icon"><i class="fa fa-cash-register"></i></span><span class="menu-label">PDV</span></a></li>
        <li><a href="dashboard.html"><span class="menu-icon"><i class="fa fa-chart-pie"></i></span><span class="menu-label">Painel</span></a></li>
        <li><a href="nfe-emissao.html"><span class="menu-icon"><i class="fa fa-file-invoice"></i></span><span class="menu-label">Notas Fiscais</span></a></li>
        <li><a href="movimentos.html"><span class="menu-icon"><i class="fa fa-exchange-alt"></i></span><span class="menu-label">Movimentos</span></a></li>
        <li><a href="relatorios.html"><span class="menu-icon"><i class="fa fa-chart-bar"></i></span><span class="menu-label">Relatórios</span></a></li>
        <li><a href="pessoas.html"><span class="menu-icon"><i class="fa fa-users"></i></span><span class="menu-label">Clientes</span></a></li>
        <li><a href="produtos.html"><span class="menu-icon"><i class="fa fa-boxes"></i></span><span class="menu-label">Produtos</span></a></li>
        <li><a href="agenda.html"><span class="menu-icon"><i class="fa fa-calendar"></i></span><span class="menu-label">Agenda</span></a></li>
        <li><a href="admin.html" class="active"><span class="menu-icon"><i class="fa fa-cogs"></i></span><span class="menu-label">Admin</span></a></li>
      </ul>
    </div>

    <div class="main-content">
      <div class="main-header">
        <h3><i class="fa fa-building"></i> Empresas</h3>
        <div class="header-info">
          <button class="btn btn-light mr-2" onclick="location.href='admin.html'"><i class="fa fa-arrow-left"></i> Voltar</button>
          <button class="btn btn-primary" onclick="openEmpresaModal()"><i class="fa fa-plus"></i> Nova Empresa</button>
        </div>
      </div>

      <div class="container-fluid py-4">
        <!-- Stats Row -->
        <div class="stats-row">
          <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">
              <i class="fa fa-building"></i>
            </div>
            <div>
              <div class="stat-value" id="totalEmpresas">0</div>
              <div class="stat-label">Empresas Cadastradas</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
              <i class="fa fa-check-circle"></i>
            </div>
            <div>
              <div class="stat-value" id="empresasAtivas">0</div>
              <div class="stat-label">Empresas Ativas</div>
            </div>
          </div>
        </div>

        <!-- Empresas List -->
        <div id="empresasList">
          <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status"></div>
            <p class="mt-3 text-muted">Carregando empresas...</p>
          </div>
        </div>
      </div>

      <footer class="footer-shortcuts">
        <div class="shortcut-item"><span><kbd>F2</kbd> Novo</span></div>
        <div class="shortcut-item"><span><kbd>F5</kbd> Atualizar</span></div>
        <div class="shortcut-item"><span><kbd>ESC</kbd> Voltar</span></div>
      </footer>
    </div>
  </div>

  <!-- Modal Cadastro - CORRIGIDO -->
  <div class="modal fade" id="empresaModal" tabindex="-1" role="dialog" aria-labelledby="empresaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="empresaModalLabel">
            <i class="fa fa-building mr-2"></i> 
            <span id="modalTitle">Nova Empresa</span>
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form id="empresaForm">
            <input type="hidden" id="empresaId">
            
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label>Razão Social <span class="text-danger">*</span></label>
                  <input type="text" id="razao_social" class="form-control" placeholder="Razão Social da Empresa" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label>Nome Fantasia <span class="text-danger">*</span></label>
                  <input type="text" id="nome_fantasia" class="form-control" placeholder="Nome Fantasia da Empresa" required>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label>CNPJ</label>
                  <input type="text" id="cnpj" class="form-control" placeholder="00.000.000/0000-00">
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Inscrição Estadual</label>
                  <input type="text" id="inscricao_estadual" class="form-control" placeholder="Inscrição Estadual">
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Inscrição Municipal</label>
                  <input type="text" id="inscricao_municipal" class="form-control" placeholder="Inscrição Municipal">
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-8">
                <div class="form-group">
                  <label>Endereço</label>
                  <input type="text" id="endereco" class="form-control" placeholder="Rua, Av, etc...">
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Número</label>
                  <input type="text" id="numero" class="form-control" placeholder="000">
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label>Bairro</label>
                  <input type="text" id="bairro" class="form-control" placeholder="Bairro">
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Cidade</label>
                  <input type="text" id="cidade" class="form-control" placeholder="Cidade">
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group">
                  <label>UF</label>
                  <select id="uf" class="form-control">
                    <option value="">--</option>
                    <option value="AC">AC</option>
                    <option value="AL">AL</option>
                    <option value="AP">AP</option>
                    <option value="AM">AM</option>
                    <option value="BA">BA</option>
                    <option value="CE">CE</option>
                    <option value="DF">DF</option>
                    <option value="ES">ES</option>
                    <option value="GO">GO</option>
                    <option value="MA">MA</option>
                    <option value="MT">MT</option>
                    <option value="MS">MS</option>
                    <option value="MG">MG</option>
                    <option value="PA">PA</option>
                    <option value="PB">PB</option>
                    <option value="PR">PR</option>
                    <option value="PE">PE</option>
                    <option value="PI">PI</option>
                    <option value="RJ">RJ</option>
                    <option value="RN">RN</option>
                    <option value="RS">RS</option>
                    <option value="RO">RO</option>
                    <option value="RR">RR</option>
                    <option value="SC">SC</option>
                    <option value="SP">SP</option>
                    <option value="SE">SE</option>
                    <option value="TO">TO</option>
                  </select>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group">
                  <label>CEP</label>
                  <input type="text" id="cep" class="form-control" placeholder="00000-000">
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label>Telefone</label>
                  <input type="text" id="telefone" class="form-control" placeholder="(00) 00000-0000">
                </div>
              </div>
              <div class="col-md-5">
                <div class="form-group">
                  <label>E-mail</label>
                  <input type="email" id="email" class="form-control" placeholder="contato@empresa.com">
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label>Status</label>
                  <select id="status" class="form-control">
                    <option value="1">Ativa</option>
                    <option value="0">Inativa</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="row" style="align-items:center;">
              <div class="col-md-6">
                <div class="form-group">
                  <label>Logo</label>
                  <div class="d-flex align-items-center" style="gap:8px;">
                    <input type="file" id="empresaLogoFile" accept="image/*" class="form-control-file" />
                    <button type="button" class="btn btn-sm btn-outline-primary" id="btnUploadLogo">Enviar</button>
                  </div>
                </div>
              </div>
              <div class="col-md-6 text-right">
                <img id="empresaLogoPreview" src="" alt="" style="max-height:64px; max-width:200px; display:none; border:1px solid #eee; padding:4px; background:#fff; border-radius:6px;" />
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            <i class="fa fa-times"></i> Cancelar
          </button>
          <button type="button" class="btn btn-primary" onclick="saveEmpresa()">
            <i class="fa fa-save"></i> Salvar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/empresa.js"></script>
</body>
</html>